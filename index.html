<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Anchor Homes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* --------- GLOBAL STYLES --------- */
    :root {
      --bg-main: #050505;
      --bg-alt: #101010;
      --bg-card: #151515;
      --accent: #ffffff;
      --accent-soft: #d3d3d3;
      --border-subtle: #2b2b2b;
      --error: #ff4d4d;
      --radius-lg: 18px;
      --shadow-soft: 0 22px 50px rgba(0, 0, 0, 0.7);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background-color: var(--bg-main);
      color: var(--accent-soft);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    .page-wrapper {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* --------- HEADER & NAV --------- */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(14px);
      background: linear-gradient(
        to bottom,
        rgba(5, 5, 5, 0.96),
        rgba(5, 5, 5, 0.88)
      );
      border-bottom: 1px solid var(--border-subtle);
    }

    .header-inner {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0.75rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.75rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.9rem;
    }

    .brand-logo {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid var(--border-subtle);
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000000;
    }

    .brand-logo img {
      max-width: 100%;
      max-height: 100%;
      display: block;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 0.12rem;
    }

    .brand-name {
      font-size: 1.15rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--accent);
    }

    .brand-tagline {
      font-size: 0.8rem;
      color: #9f9f9f;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    nav {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .nav-link {
      font-size: 0.85rem;
      padding: 0.45rem 0.95rem;
      border-radius: 999px;
      border: 1px solid transparent;
      color: #c0c0c0;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease,
        transform 0.1s ease;
      background: transparent;
    }

    .nav-link:hover {
      background: #1c1c1c;
      border-color: var(--border-subtle);
      color: var(--accent);
      transform: translateY(-1px);
    }

    .nav-link.active {
      background: #ffffff;
      color: #000000;
      border-color: #ffffff;
    }

    main {
      flex: 1;
    }

    .content {
      max-width: 1120px;
      margin: 1.5rem auto 2.5rem;
      padding: 0 1.5rem;
    }

    .card {
      background: radial-gradient(circle at top left, #222222 0, #121212 45%, #050505 100%);
      border-radius: var(--radius-lg);
      padding: 1.75rem 1.6rem 2.1rem;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-subtle);
      margin-bottom: 1.5rem;
    }

    .card-header {
      margin-bottom: 1.25rem;
      border-bottom: 1px solid var(--border-subtle);
      padding-bottom: 0.9rem;
    }

    .card-title {
      font-size: 1.45rem;
      color: var(--accent);
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .card-subtitle {
      font-size: 0.85rem;
      color: #9f9f9f;
      margin-top: 0.45rem;
    }

    .muted {
      color: #aaaaaa;
      font-size: 0.95rem;
    }

    .two-column {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 2rem;
      align-items: flex-start;
    }

    .info-block {
      margin-bottom: 1rem;
    }

    .info-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #b0b0b0;
      margin-bottom: 0.2rem;
    }

    .info-value {
      font-size: 1rem;
      color: var(--accent);
    }

    /* --------- FORMS --------- */

    form {
      display: grid;
      gap: 1rem;
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: #bbbbbb;
    }

    .label-sub {
      font-size: 0.75rem;
      color: #8c8c8c;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="file"],
    textarea {
      padding: 0.7rem 0.85rem;
      border-radius: 11px;
      border: 1px solid var(--border-subtle);
      background-color: var(--bg-alt);
      color: var(--accent);
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      width: 100%;
    }

    input::placeholder,
    textarea::placeholder {
      color: #777777;
    }

    input:focus,
    textarea:focus {
      border-color: #ffffff;
      box-shadow: 0 0 0 1px #ffffff22;
      background-color: #181818;
    }

    textarea {
      min-height: 130px;
      resize: vertical;
    }

    .hint {
      font-size: 0.8rem;
      color: #8a8a8a;
    }

    .button-row {
      margin-top: 0.5rem;
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      padding: 0.65rem 1.5rem;
      border: none;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s ease,
        color 0.2s ease, border-color 0.2s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background-color: #ffffff;
      color: #000000;
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.6);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 34px rgba(0, 0, 0, 0.8);
    }

    .btn-outline {
      background: transparent;
      color: var(--accent);
      border: 1px solid var(--accent);
    }

    .btn-outline:hover {
      background: #ffffff;
      color: #000000;
    }

    .btn-sm {
      padding: 0.35rem 0.85rem;
      font-size: 0.7rem;
      letter-spacing: 0.14em;
    }

    .required {
      color: var(--error);
      margin-left: 0.1rem;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    footer {
      border-top: 1px solid var(--border-subtle);
      padding: 1rem 1.5rem 1.5rem;
      font-size: 0.8rem;
      color: #777777;
      text-align: center;
    }

    /* --------- HERO --------- */
    .hero {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 2rem;
      align-items: center;
    }

    .hero-title {
      font-size: 2rem;
      color: var(--accent);
      letter-spacing: 0.16em;
      text-transform: uppercase;
      margin-bottom: 0.75rem;
    }

    .hero-tagline {
      font-size: 1.05rem;
      color: #d0d0d0;
      margin-bottom: 1.25rem;
    }

    .hero-highlights {
      list-style: none;
      padding-left: 1rem;
      margin-bottom: 1.5rem;
    }

    .hero-highlights li::before {
      content: "– ";
      color: #ffffff;
    }

    .hero-image-frame {
      border-radius: var(--radius-lg);
      overflow: hidden;
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-soft);
      background: #000;
      position: relative;
      min-height: 260px;
    }

    .hero-image-frame img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.7s ease;
    }

    .hero-image-frame img.active {
      opacity: 1;
    }

    /* --------- MISC --------- */
    .section-divider {
      height: 1px;
      background: #262626;
      margin: 1.4rem 0;
      border-radius: 999px;
    }

    .pill-label {
      display: inline-block;
      border-radius: 999px;
      border: 1px solid #333333;
      padding: 0.15rem 0.65rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #9c9ccf;
      margin-bottom: 0.45rem;
    }

    .signature-pad {
      margin-top: 0.35rem;
      padding: 0.6rem;
      border-radius: 12px;
      border: 1px solid #2a2a2a;
      background: #0c0c0c;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .signature-pad canvas {
      width: 100%;
      height: 120px;
      border-radius: 10px;
      background: #111111;
      border: 1px dashed #3a3a3a;
      touch-action: none;
    }

    .signature-note {
      font-size: 0.75rem;
      color: #8a8a8a;
      margin-top: 0.25rem;
    }

    /* --------- PDF OVERLAY --------- */
    .pdf-overlay {
      position: relative;
      border-radius: 14px;
      border: 1px solid #262626;
      background: #111;
      overflow: hidden;
      max-width: 100%;
      margin-top: 0.75rem;
    }

    .pdf-overlay img {
      display: block;
      width: 100%;
      height: auto;
      pointer-events: none;
      user-select: none;
    }

    .pdf-overlay-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .pdf-field {
      position: absolute;
      pointer-events: auto;
    }

    .pdf-field input[type="text"],
    .pdf-field input[type="email"],
    .pdf-field input[type="tel"],
    .pdf-field textarea {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 4px;
      border: 1px solid #444444;
      padding: 0.05rem 0.18rem;
      font-size: 0.75rem;
      color: #000000;
      width: 100%;
    }

    .pdf-field textarea {
      resize: none;
      height: 1.4rem;
    }

    .pdf-field .signature-pad {
      background: transparent;
      border: none;
      padding: 0;
    }

    .pdf-field .signature-pad canvas {
      background: transparent;
      border: 1px solid #000000;
      height: 70px;
    }

    .pdf-field .btn-sm {
      margin-top: 0.2rem;
      padding: 0.2rem 0.5rem;
      font-size: 0.6rem;
    }

    .pdf-field input[type="checkbox"] {
      width: 0.85rem;
      height: 0.85rem;
      accent-color: #000000;
    }

    @media (max-width: 768px) {
      .header-inner {
        flex-direction: column;
        align-items: flex-start;
      }

      nav {
        width: 100%;
        justify-content: flex-start;
      }

      .two-column,
      .hero {
        grid-template-columns: minmax(0, 1fr);
      }

      .card {
        padding: 1.25rem 1.1rem 1.7rem;
      }
    }
  </style>
</head>

<body>
  <div class="page-wrapper">
    <header>
      <div class="header-inner">
        <div class="brand">
          <div class="brand-logo">
            <img src="logo.png" alt="Anchor Homes logo" />
          </div>
          <div class="brand-text">
            <div class="brand-name">Anchor Homes</div>
            <div class="brand-tagline">Custom Homes &amp; Renovations</div>
          </div>
        </div>

        <nav>
          <button class="nav-link active" data-section="welcome">Welcome</button>
          <button class="nav-link" data-section="about">About Us</button>
          <button class="nav-link" data-section="services">Services</button>
          <button class="nav-link" data-section="change-requests">Change Request</button>
          <button class="nav-link" data-section="subcontractors">Invoices</button>
          <button class="nav-link" data-section="new-subcontractors">New Subcontractors</button>
          <button class="nav-link" data-section="contact">Contact</button>
        </nav>
      </div>
    </header>

    <main>
      <div class="content">
        <!-- WELCOME, ABOUT, SERVICES, CHANGE REQUEST, INVOICES, CONTACT
             (unchanged from your backup, so omitted here for brevity)
             ... -->

        <!-- --------- NEW SUBCONTRACTORS --------- -->
        <section id="new-subcontractors" class="section">
          <div class="card">
            <div class="card-header">
              <h1 class="card-title">New Subcontractors</h1>
              <p class="card-subtitle">
                Complete the Subcontractor Agreement, W-9, and upload your Certificate of Insurance.
                / Complete el Acuerdo de Subcontratista, el W-9 y cargue su Certificado de Seguro.
              </p>
            </div>

            <form
              id="new-subcontractor-form"
              action="https://formspree.io/f/YOUR_NEW_SUBCONTRACTOR_FORM_ID"
              method="POST"
              enctype="multipart/form-data"
              accept-charset="UTF-8"
            >
              <input type="hidden" name="form_name" value="New Subcontractor Packet" />

              <!-- SECTION A – BASIC INFO -->
              <span class="pill-label">
                Section A – Subcontractor Information / Información del Subcontratista
              </span>

              <div class="two-column" style="margin-top:0.75rem;">
                <div class="field-group">
                  <label for="ns-name">
                    Subcontractor Name / Nombre del Subcontratista<span class="required">*</span>
                  </label>
                  <input
                    type="text"
                    id="ns-name"
                    name="ns_name"
                    required
                    placeholder="Legal name"
                  />
                </div>

                <div class="field-group">
                  <label for="ns-company">
                    Company / Empresa
                  </label>
                  <input
                    type="text"
                    id="ns-company"
                    name="ns_company"
                    placeholder="Business or DBA name"
                  />
                </div>
              </div>

              <div class="two-column">
                <div class="field-group">
                  <label for="ns-email">
                    Email / Correo electrónico<span class="required">*</span>
                  </label>
                  <input
                    type="email"
                    id="ns-email"
                    name="ns_email"
                    required
                    placeholder="you@company.com"
                  />
                </div>

                <div class="field-group">
                  <label for="ns-phone">
                    Phone / Teléfono<span class="required">*</span>
                  </label>
                  <input
                    type="tel"
                    id="ns-phone"
                    name="ns_phone"
                    required
                    placeholder="(555) 555-5555"
                  />
                </div>
              </div>

              <div class="field-group">
                <label for="ns-address">
                  Mailing Address / Dirección Postal<span class="required">*</span>
                </label>
                <input
                  type="text"
                  id="ns-address"
                  name="ns_address"
                  required
                  placeholder="Street address, city, state, ZIP"
                />
              </div>

              <div class="two-column">
                <div class="field-group">
                  <label for="ns-trade">
                    Trade / Scope of Work<br />
                    <span class="label-sub">Oficio / Alcance del Trabajo</span>
                  </label>
                  <input
                    type="text"
                    id="ns-trade"
                    name="ns_trade"
                    placeholder="Framing, electrical, concrete, etc."
                  />
                </div>

                <div class="field-group">
                  <label for="ns-other">
                    Notes / Notas
                  </label>
                  <input
                    type="text"
                    id="ns-other"
                    name="ns_other_notes"
                    placeholder="Any additional info (optional)"
                  />
                </div>
              </div>

              <div class="section-divider"></div>

              <!-- SECTION B – Subcontractor Agreement / Acuerdo de Subcontratista -->
<span class="pill-label">
  Section B – Subcontractor Agreement / Acuerdo de Subcontratista
</span>

<!-- Pages 1–3: READ-ONLY for review -->
<div class="pdf-overlay" style="margin-top:1rem;">
  <img src="Sub Contractor Agreement_Page_1.png" alt="Subcontractor Agreement – Page 1" />
  <div class="pdf-overlay-layer"></div>
</div>

<div class="pdf-overlay" style="margin-top:1rem;">
  <img src="Sub Contractor Agreement_Page_2.png" alt="Subcontractor Agreement – Page 2" />
  <div class="pdf-overlay-layer"></div>
</div>

<div class="pdf-overlay" style="margin-top:1rem;">
  <img src="Sub Contractor Agreement_Page_3.png" alt="Subcontractor Agreement – Page 3" />
  <div class="pdf-overlay-layer"></div>
</div>

<!-- Page 4: SIGNABLE with overlayed fields -->
<div class="pdf-overlay" style="margin-top:1rem;">
  <img src="Sub Contractor Agreement_Page_4.png" alt="Subcontractor Agreement – Page 4" />
  <div class="pdf-overlay-layer">

    <!-- Name of Subcontractor -->
    <div class="pdf-field" style="top:720px; left:50px; width:400px;">
      <input type="text" name="subcontractor_name" placeholder="Subcontractor Name" />
    </div>

    <!-- Anchor Homes LLC (pre-filled) -->
    <div class="pdf-field" style="top:720px; left:550px; width:400px;">
      <input type="text" name="builder_name" value="Anchor Homes LLC" readonly />
    </div>

    <!-- Subcontractor Signature -->
    <div class="pdf-field" style="top:760px; left:50px; width:400px;">
      <div class="signature-pad" data-input-id="subcontractor_signature">
        <canvas id="signature-sub"></canvas>
        <button type="button" class="btn btn-outline btn-sm signature-clear">Clear</button>
      </div>
      <input type="hidden" name="subcontractor_signature" id="subcontractor_signature" />
    </div>

    <!-- Builder Signature -->
    <div class="pdf-field" style="top:760px; left:550px; width:400px;">
      <div class="signature-pad" data-input-id="builder_signature">
        <canvas id="signature-builder"></canvas>
        <button type="button" class="btn btn-outline btn-sm signature-clear">Clear</button>
      </div>
      <input type="hidden" name="builder_signature" id="builder_signature" />
    </div>

    <!-- Titles -->
    <div class="pdf-field" style="top:880px; left:50px; width:400px;">
      <input type="text" name="subcontractor_title" placeholder="Subcontractor Title" />
    </div>
    <div class="pdf-field" style="top:880px; left:550px; width:400px;">
      <input type="text" name="builder_title" placeholder="Builder Title" />
    </div>

    <!-- Dates -->
    <div class="pdf-field" style="top:920px; left:50px; width:400px;">
      <input type="date" name="subcontractor_date" />
    </div>
    <div class="pdf-field" style="top:920px; left:550px; width:400px;">
      <input type="date" name="builder_date" />
    </div>
  </div>
</div>

              <div class="section-divider"></div>

              <!-- SECTION C – IRS W-9 -->
              <span class="pill-label">
                Section C – IRS W-9 / Formulario W-9
              </span>

              <!-- Static W-9 preview for reference -->
              <div class="pdf-overlay" style="margin-top:1rem;">
                <!-- Replace fw9-page1.png with your W-9 preview image path if different -->
                <img src="fw9-page1.png" alt="Blank W-9 preview" style="width:100%; height:auto;" />
              </div>

              <!-- W-9 data-entry fields (filled below and overlaid onto the PDF before sending) -->
              <div class="card" style="margin-top:1rem; background:rgba(5,5,5,0.6);">
                <div class="card-header" style="border-bottom:none; padding-bottom:0.4rem;">
                  <h2 class="card-title" style="font-size:1rem;">W-9 Information</h2>
                </div>

                <div class="field-group">
                  <label for="w9_name_input">Name (as on tax return)</label>
                  <input
                    type="text"
                    id="w9_name_input"
                    name="w9_name_raw"
                    placeholder="Legal name"
                    required
                  />
                </div>

                <div class="field-group">
                  <label for="w9_business_input">Business name / disregarded entity name</label>
                  <input
                    type="text"
                    id="w9_business_input"
                    name="w9_business_raw"
                    placeholder="Business / DBA name"
                  />
                </div>

                <div class="field-group">
                  <label>Federal tax classification</label>
                  <div style="display:flex; flex-wrap:wrap; gap:0.9rem; font-size:0.85rem;">
                    <label><input type="radio" name="w9_entity_raw" value="Individual/sole proprietor" required /> Individual / Sole proprietor</label>
                    <label><input type="radio" name="w9_entity_raw" value="C corporation" /> C Corporation</label>
                    <label><input type="radio" name="w9_entity_raw" value="S corporation" /> S Corporation</label>
                    <label><input type="radio" name="w9_entity_raw" value="Partnership" /> Partnership</label>
                    <label><input type="radio" name="w9_entity_raw" value="Trust/estate" /> Trust / Estate</label>
                    <label><input type="radio" name="w9_entity_raw" value="LLC" /> LLC</label>
                    <label><input type="radio" name="w9_entity_raw" value="Other" /> Other</label>
                  </div>
                </div>

                <div class="field-group">
                  <label for="w9_address_input">Address</label>
                  <input
                    type="text"
                    id="w9_address_input"
                    name="w9_address_raw"
                    placeholder="Number, street, apt/suite"
                    required
                  />
                </div>

                <div class="field-group">
                  <label for="w9_city_state_input">City, State, ZIP</label>
                  <input
                    type="text"
                    id="w9_city_state_input"
                    name="w9_city_state_raw"
                    placeholder="City, ST ZIP"
                    required
                  />
                </div>

                <div class="field-group">
                  <label>Signature (W-9)</label>
                  <div class="signature-pad" data-input-id="w9_signature">
                    <canvas id="signature-w9"></canvas>
                    <button type="button" class="btn btn-outline btn-sm signature-clear">Clear</button>
                  </div>
                  <input type="hidden" name="w9_signature" id="w9_signature" />
                  <p class="hint">Sign inside the box. / Firme dentro del cuadro.</p>
                </div>

                <div class="field-group">
                  <label for="w9_date_input">Date</label>
                  <input
                    type="text"
                    id="w9_date_input"
                    name="w9_date_raw"
                    placeholder="MM/DD/YYYY"
                    required
                  />
                </div>
              </div>

              <!-- Will hold a base64 copy of the filled W-9 PDF (for email body if desired) -->
              <input type="hidden" name="w9_filled_pdf_base64" id="w9_filled_pdf_base64" />

              <div class="section-divider"></div>

              <!-- SECTION D – Certificate of Insurance -->
              <span class="pill-label">
                Section D – Certificate of Insurance / Certificado de Seguro
              </span>

              <div class="field-group" style="margin-top:0.75rem;">
                <label for="ns-coi">
                  Upload Certificate of Insurance<span class="required">*</span><br />
                  <span class="label-sub">Cargue su Certificado de Seguro</span>
                </label>
                <input
                  type="file"
                  id="ns-coi"
                  name="ns_coi_file"
                  required
                  accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                />
                <p class="hint">
                  Please upload a current Certificate of Insurance listing Anchor Homes as
                  certificate holder. / Cargue un Certificado de Seguro vigente que incluya a
                  Anchor Homes como titular del certificado.
                </p>
              </div>

              <div class="button-row" style="margin-top:1rem;">
                <button type="submit" class="btn btn-primary">
                  Submit New Subcontractor Packet
                </button>
                <button type="reset" class="btn btn-outline">
                  Clear All / Borrar Todo
                </button>
              </div>
            </form>
          </div>
        </section>

        <!-- CONTACT SECTION (unchanged from backup) -->
        <section id="contact" class="section">
          <div class="card">
            <div class="card-header">
              <h1 class="card-title">Contact</h1>
              <p class="card-subtitle">
                Reach out to Anchor Homes for questions, consultations, or project updates.
              </p>
            </div>

            <div class="two-column">
              <div>
                <div class="info-block">
                  <div class="info-label">Phone</div>
                  <div class="info-value">(555) 555-5555</div>
                </div>
                <div class="info-block">
                  <div class="info-label">Email</div>
                  <div class="info-value">
                    <a href="mailto:info@anchorhomes.com">info@anchorhomes.com</a>
                  </div>
                </div>
                <div class="info-block">
                  <div class="info-label">Business Address</div>
                  <div class="info-value">
                    1234 Anchor Way<br />
                    Suite 100<br />
                    Your City, ST 00000
                  </div>
                </div>
              </div>

              <div>
                <p class="muted">
                  Office hours, service areas, or additional contact notes can be listed here. For
                  example: “Meetings by appointment only,” or “Serving Williamson County and the
                  Greater Nashville area.”
                </p>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <footer>
      &copy; <span id="year"></span> Anchor Homes. All rights reserved.
    </footer>
  </div>

  <!-- Signature Pad + PDF-lib libraries and capture script -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad"></script>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      /* ----- NAVIGATION ----- */
      const navLinks = document.querySelectorAll(".nav-link");
      const sections = document.querySelectorAll(".section");

      function activateSection(targetId) {
        navLinks.forEach((l) => {
          const id = l.getAttribute("data-section");
          l.classList.toggle("active", id === targetId);
        });
        sections.forEach((section) => {
          section.classList.toggle("active", section.id === targetId);
        });
      }

      navLinks.forEach((link) => {
        link.addEventListener("click", () => {
          const targetId = link.getAttribute("data-section");
          activateSection(targetId);
        });
      });

      document.querySelectorAll("[data-jump]").forEach((btn) => {
        btn.addEventListener("click", () => {
          const targetId = btn.getAttribute("data-jump");
          activateSection(targetId);
        });
      });

      /* ----- FOOTER YEAR ----- */
      const yearSpan = document.getElementById("year");
      if (yearSpan) yearSpan.textContent = new Date().getFullYear();

      /* ----- HERO SLIDESHOW ----- */
      const slides = Array.from(document.querySelectorAll(".hero-slide") || []);
      if (slides.length > 1) {
        let order = slides.map((_, idx) => idx);
        function shuffle(array) {
          for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
          }
        }
        shuffle(order);
        let pointer = 0;
        function showNextSlide() {
          const index = order[pointer];
          slides.forEach((slide, i) => {
            slide.classList.toggle("active", i === index);
          });
          pointer++;
          if (pointer >= order.length) {
            pointer = 0;
            shuffle(order);
          }
        }
        showNextSlide();
        setInterval(showNextSlide, 5000);
      }

      /* ----- SignaturePad instances for overlays ----- */
      const subCanvas = document.getElementById('signature-sub');
      const builderCanvas = document.getElementById('signature-builder');
      const w9Canvas = document.getElementById('signature-w9');

      const subSig = subCanvas ? new SignaturePad(subCanvas, { penColor: '#000' }) : null;
      const builderSig = builderCanvas ? new SignaturePad(builderCanvas, { penColor: '#000' }) : null;
      const w9Sig = w9Canvas ? new SignaturePad(w9Canvas, { penColor: '#000' }) : null;

      const { PDFDocument, StandardFonts, rgb } = PDFLib;

      async function buildFilledW9PDF() {
        // Fetch the blank W-9 PDF (adjust the path/filename as needed to match your server)
        const blankPdfBytes = await fetch("w9.pdf").then(res => res.arrayBuffer());

        const pdfDoc = await PDFDocument.load(blankPdfBytes);
        const page = pdfDoc.getPage(0);

        const font = await pdfDoc.embedFont(StandardFonts.Helvetica);
        const fontSize = 10;
        const textColor = rgb(0, 0, 0);

        // Read values from the visible W-9 inputs
        const name = document.getElementById("w9_name_input").value || "";
        const business = document.getElementById("w9_business_input").value || "";
        const address = document.getElementById("w9_address_input").value || "";
        const cityStateZip = document.getElementById("w9_city_state_input").value || "";
        const date = document.getElementById("w9_date_input").value || "";
        const entityRadio = document.querySelector("input[name='w9_entity_raw']:checked");
        const entityType = entityRadio ? entityRadio.value : "";

        // Signature canvas for W-9
        const sigCanvas = document.getElementById("signature-w9");
        const sigDataUrl = sigCanvas.toDataURL("image/png");
        const sigImageBytes = await fetch(sigDataUrl).then(res => res.arrayBuffer());
        const sigImage = await pdfDoc.embedPng(sigImageBytes);
        const sigDims = sigImage.scale(0.5); // tweak scale if needed

        const { width, height } = page.getSize();

        // Example coordinates for a standard 8.5x11 W-9.
        // You will likely want to nudge these values so they line up perfectly
        // with your specific PDF.
        const nameX = 90,          nameY = height - 120;
        const businessX = 90,      businessY = height - 140;
        const addressX = 90,       addressY = height - 210;
        const cityX = 90,          cityY = height - 230;
        const entityX = 350,       entityY = height - 160;
        const dateX = 410,         dateY = height - 410;
        const sigX = 90,           sigY = height - 420;

        page.drawText(name, {
          x: nameX,
          y: nameY,
          size: fontSize,
          font,
          color: textColor,
        });

        page.drawText(business, {
          x: businessX,
          y: businessY,
          size: fontSize,
          font,
          color: textColor,
        });

        page.drawText(address, {
          x: addressX,
          y: addressY,
          size: fontSize,
          font,
          color: textColor,
        });

        page.drawText(cityStateZip, {
          x: cityX,
          y: cityY,
          size: fontSize,
          font,
          color: textColor,
        });

        if (entityType) {
          page.drawText("Entity: " + entityType, {
            x: entityX,
            y: entityY,
            size: fontSize,
            font,
            color: textColor,
          });
        }

        page.drawText(date, {
          x: dateX,
          y: dateY,
          size: fontSize,
          font,
          color: textColor,
        });

        // Draw signature image onto the PDF
        page.drawImage(sigImage, {
          x: sigX,
          y: sigY,
          width: sigDims.width,
          height: sigDims.height,
        });

        const filledPdfBytes = await pdfDoc.save();
        return filledPdfBytes;
      }

      const newSubForm = document.getElementById('new-subcontractor-form');
      if (newSubForm) {
        newSubForm.addEventListener('submit', async function (e) {
          e.preventDefault();

          // Capture existing SignaturePad canvases into their hidden fields
          if (subSig && !subSig.isEmpty()) {
            document.getElementById('subcontractor_signature').value = subSig.toDataURL();
          }
          if (builderSig && !builderSig.isEmpty()) {
            document.getElementById('builder_signature').value = builderSig.toDataURL();
          }
          if (w9Sig && !w9Sig.isEmpty()) {
            document.getElementById('w9_signature').value = w9Sig.toDataURL();
          }

          try {
            // Build the filled W-9 PDF
            const filledW9Bytes = await buildFilledW9PDF();

            // Optional: store base64 in hidden field (useful to see it in the email body)
            const base64W9 = btoa(String.fromCharCode(...new Uint8Array(filledW9Bytes)));
            const base64Field = document.getElementById("w9_filled_pdf_base64");
            if (base64Field) {
              base64Field.value = "data:application/pdf;base64," + base64W9;
            }

            // Build FormData from the form (includes all fields + signatures)
            const formData = new FormData(newSubForm);

            // Add the filled W-9 PDF as a file attachment
            const w9Blob = new Blob([filledW9Bytes], { type: "application/pdf" });
            formData.append("w9_filled_pdf", w9Blob, "w9-filled.pdf");

            // Post to the same Formspree endpoint used by the form's action attribute
            const endpoint = newSubForm.getAttribute("action");
            const response = await fetch(endpoint, {
              method: "POST",
              body: formData,
            });

            if (response.ok) {
              alert("Thank you! Your subcontractor packet was submitted successfully.");
              newSubForm.reset();

              if (subSig) subSig.clear();
              if (builderSig) builderSig.clear();
              if (w9Sig) w9Sig.clear();
            } else {
              alert("There was a problem submitting the form. Please try again or contact us.");
            }
          } catch (err) {
            console.error("Error generating or submitting filled W-9:", err);
            alert("There was an error generating the W-9. Please try again.");
          }
        });
      }
    });
  </script>
</body>
</html>
